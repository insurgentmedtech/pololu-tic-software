require_relative 'spec_helper'

TicRecommendedCurrentCodeDump = <<END
T825
0,0
1,32
2,64
3,96
4,128
5,160
6,192
7,224
8,256
9,288
10,320
11,352
12,384
13,416
14,448
15,480
16,512
17,544
18,576
19,608
20,640
21,672
22,704
23,736
24,768
25,800
26,832
27,864
28,896
29,928
30,960
31,992
32,1024
34,1088
36,1152
38,1216
40,1280
42,1344
44,1408
46,1472
48,1536
50,1600
52,1664
54,1728
56,1792
58,1856
60,1920
62,1984
64,2048
68,2176
72,2304
76,2432
80,2560
84,2688
88,2816
92,2944
96,3072
100,3200
104,3328
108,3456
112,3584
116,3712
120,3840
124,3968
T834
0,0
1,32
2,64
3,96
4,128
5,160
6,192
7,224
8,256
9,288
10,320
11,352
12,384
13,416
14,448
15,480
16,512
17,544
18,576
19,608
20,640
21,672
22,704
23,736
24,768
25,800
26,832
27,864
28,896
29,928
30,960
31,992
32,1024
34,1088
36,1152
38,1216
40,1280
42,1344
44,1408
46,1472
48,1536
50,1600
52,1664
54,1728
56,1792
58,1856
60,1920
62,1984
64,2048
68,2176
72,2304
76,2432
80,2560
84,2688
88,2816
92,2944
96,3072
100,3200
104,3328
108,3456
T500
0,0
1,1
2,174
3,343
4,495
5,634
6,762
7,880
8,990
9,1092
10,1189
11,1281
12,1368
13,1452
14,1532
15,1611
16,1687
17,1762
18,1835
19,1909
20,1982
21,2056
22,2131
23,2207
24,2285
25,2366
26,2451
27,2540
28,2634
29,2734
30,2843
31,2962
32,3093
N825
0,0
1,32
2,64
3,96
4,128
5,160
6,192
7,224
8,256
9,288
10,320
11,352
12,384
13,416
14,448
15,480
16,512
17,544
18,576
19,608
20,640
21,672
22,704
23,736
24,768
25,800
26,832
27,864
28,896
29,928
30,960
31,992
32,1024
34,1088
36,1152
38,1216
40,1280
42,1344
44,1408
46,1472
48,1536
50,1600
52,1664
54,1728
56,1792
58,1856
60,1920
62,1984
64,2048
68,2176
72,2304
76,2432
80,2560
84,2688
88,2816
92,2944
96,3072
100,3200
104,3328
108,3456
112,3584
116,3712
120,3840
124,3968
T249
0,0
1,40
2,80
3,120
4,160
5,200
6,240
7,280
8,320
9,360
10,400
11,440
12,480
13,520
14,560
15,600
16,640
17,680
18,720
19,760
20,800
21,840
22,880
23,920
24,960
25,1000
26,1040
27,1080
28,1120
29,1160
30,1200
31,1240
32,1280
34,1360
36,1440
38,1520
40,1600
42,1680
44,1760
46,1840
48,1920
50,2000
52,2080
54,2160
56,2240
58,2320
60,2400
62,2480
64,2560
68,2720
72,2880
76,3040
80,3200
84,3360
88,3520
92,3680
96,3840
100,4000
104,4160
108,4320
112,4480
36v4
0,0
1,36
2,72
3,107
4,143
5,179
6,215
7,251
8,286
9,322
10,358
11,394
12,430
13,465
14,501
15,537
16,573
17,609
18,645
19,680
20,716
21,752
22,788
23,824
24,859
25,895
26,931
27,967
28,1003
29,1038
30,1074
31,1110
32,1146
33,1182
34,1217
35,1253
36,1289
37,1325
38,1361
39,1396
40,1432
41,1468
42,1504
43,1540
44,1576
45,1611
46,1647
47,1683
48,1719
49,1755
50,1790
51,1826
52,1862
53,1898
54,1934
55,1969
56,2005
57,2041
58,2077
59,2113
60,2148
61,2184
62,2220
63,2256
64,2292
65,2327
66,2363
67,2399
68,2435
69,2471
70,2507
71,2542
72,2578
73,2614
74,2650
75,2686
76,2721
77,2757
78,2793
79,2829
80,2865
81,2900
82,2936
83,2972
84,3008
85,3044
86,3079
87,3115
88,3151
89,3187
90,3223
91,3258
92,3294
93,3330
94,3366
95,3402
96,3438
97,3473
98,3509
99,3545
100,3581
101,3617
102,3652
103,3688
104,3724
105,3760
106,3796
107,3831
108,3867
109,3903
110,3939
111,3975
112,4010
113,4046
114,4082
115,4118
116,4154
117,4189
118,4225
119,4261
120,4297
121,4333
122,4368
123,4404
124,4440
125,4476
126,4512
127,4548
128,4583
129,4619
130,4655
131,4691
132,4727
133,4762
134,4798
135,4834
136,4870
137,4906
138,4941
139,4977
140,5013
141,5049
142,5085
143,5120
144,5156
145,5192
146,5228
147,5264
148,5299
149,5335
150,5371
151,5407
152,5443
153,5479
154,5514
155,5550
156,5586
157,5622
158,5658
159,5693
160,5729
161,5765
162,5801
163,5837
164,5872
165,5908
166,5944
167,5980
168,6016
169,6051
170,6087
171,6123
172,6159
173,6195
174,6230
175,6266
176,6302
177,6338
178,6374
179,6410
180,6445
181,6481
182,6517
183,6553
184,6589
185,6624
186,6660
187,6696
188,6732
189,6768
190,6803
191,6839
192,6875
193,6911
194,6947
195,6982
196,7018
197,7054
198,7090
199,7126
200,7161
201,7197
202,7233
203,7269
204,7305
205,7340
206,7376
207,7412
208,7448
209,7484
210,7520
211,7555
212,7591
213,7627
214,7663
215,7699
216,7734
217,7770
218,7806
219,7842
220,7878
221,7913
222,7949
223,7985
224,8021
225,8057
226,8092
227,8128
228,8164
229,8200
230,8236
231,8271
232,8307
233,8343
234,8379
235,8415
236,8451
237,8486
238,8522
239,8558
240,8594
241,8630
242,8665
243,8701
244,8737
245,8773
246,8809
247,8844
248,8880
249,8916
250,8952
251,8988
252,9023
253,9059
254,9095
255,9131
END

describe 'current limit code' do
  it 'works' do
    # The C++ side tests a lot of things about the current limit.  We run it to
    # make sure there are no errors, that the set of recommended codes hasn't
    # changed by accident, and we also check to make sure it up-to-date and is
    # actually testing every product.
    stdout, stderr, code = run_ticcmd('--test 3')
    expect(stderr).to eq ''
    expect(stdout).to eq TicRecommendedCurrentCodeDump
    expect(code).to eq 0

    TicProductSymbols.each do |sym|
      expect(stdout).to include(sym.to_s)
    end
  end
end
